<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Add Workout</title>
</head>
<body>
  <h1>Add Workout</h1>
  <input type="text" id="exercise" placeholder="Exercise">
  <input type="number" id="sets" placeholder="Sets">
  <input type="number" id="reps" placeholder="Reps">
  <input type="number" id="weight" placeholder="Weight (kg)">
  <button onclick="addWorkout()">Add Workout</button>
  <button onclick="goHome()">Home</button>
  <button onclick="viewWorkouts()">View My Workouts</button>

  <script>
    const userId = localStorage.getItem('userId');
    if (!userId) window.location.href = '/';

    async function addWorkout() {
      const exercise = document.getElementById('exercise').value.trim();
      const sets = parseInt(document.getElementById('sets').value);
      const reps = parseInt(document.getElementById('reps').value);
      const weight = parseInt(document.getElementById('weight').value) || 0;

      if (!exercise || !sets || !reps) {
        alert("Exercise, sets, and reps are required");
        return;
      }

      try {
        const res = await fetch(`/api/workouts/${userId}`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ exercise, sets, reps, weight })
        });

        const data = await res.json();
        alert("Workout added!");
        // Clear inputs
        document.getElementById('exercise').value = '';
        document.getElementById('sets').value = '';
        document.getElementById('reps').value = '';
        document.getElementById('weight').value = '';
      } catch (err) {
        console.error(err);
        alert("Error adding workout");
      }
    }

    function goHome() {
      window.location.href = '/';
    }

    function viewWorkouts() {
      window.location.href = '/view.html';
    }
  </script>
</body>
</html>
